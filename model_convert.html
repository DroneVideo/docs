
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Model Conversion Pipeline Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="openvino.html" />
    
    
    <link rel="prev" href="rs2.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="bytetrack.html">
            
                <a href="bytetrack.html">
            
                    
                    ByteTrack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="nanodet.html">
            
                <a href="nanodet.html">
            
                    
                    NanoDet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="ros.html">
            
                <a href="ros.html">
            
                    
                    ROS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="rs2.html">
            
                <a href="rs2.html">
            
                    
                    Intel RealSense 2
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6" data-path="model_convert.html">
            
                <a href="model_convert.html">
            
                    
                    Model Conversion Pipeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="openvino.html">
            
                <a href="openvino.html">
            
                    
                    OpenVino
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="setup.html">
            
                <a href="setup.html">
            
                    
                    Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="troubleshooting.html">
            
                <a href="troubleshooting.html">
            
                    
                    Troubleshotting
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Model Conversion Pipeline</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="intel-openvino">Intel OpenVINO</h1>
<p>Our object detection model is converted from PyTorch to ONNX to OpenVINO. This is because OpenVINO accelerates the performance of machine learning models with advantages in many areas. OpenVINO integration allows inline conversion of input shape models, graph partitioning, support for INT8 models, and Docker Containers. Essentially, it provides us the model optimization necessary for our low power computer vision solution.</p>
<h2 id="converting-a-pytorch-model-to-openvino">Converting a PyTorch model to OpenVINO</h2>
<ol>
<li><p>If you haven&apos;t already:</p>
<p> <a href="https://github.com/DroneVideo/docs/blob/gh-pages/openvino.md" target="_blank">Install OpenVINO</a></p>
<p> <a href="https://github.com/DroneVideo/docs/blob/gh-pages/setup.md" target="_blank">Install pip requirements</a> (step 3)</p>
</li>
<li><p>Export ONNX model</p>
</li>
</ol>
<p>The Python script for this action can be found <a href="https://github.com/DroneVideo/object-tracking-2022" target="_blank">here</a></p>
<pre><code class="lang-shell">   python ./export_onnx.py --cfg_path ${CONFIG_PATH} --model_path ${PYTORCH_MODEL_PATH}
</code></pre>
<ol>
<li><p>Use <em>onnx-simplifier</em> to simplify it</p>
<pre><code class="lang-shell">python -m onnxsim ${INPUT_ONNX_MODEL} ${OUTPUT_ONNX_MODEL}
</code></pre>
</li>
<li><p>Convert to OpenVINO</p>
<pre><code class="lang-shell">cd &lt;INSTSLL_DIR&gt;/openvino_2021.4.752/deployment_tools/model_optimizer
</code></pre>
<p>Install requirements for convert tool</p>
<pre><code class="lang-shell">sudo ./install_prerequisites/install_prerequisites_onnx.sh
</code></pre>
<p>Then convert model. Notice: mean_values and scale_values should be the same with your training settings in YAML config file.</p>
<pre><code class="lang-shell">python3 mo_onnx.py --input_model &lt;ONNX_MODEL&gt; --mean_values [103.53,116.28,123.675] --scale_values [57.375,57.12,58.395]
</code></pre>
</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="rs2.html" class="navigation navigation-prev " aria-label="Previous page: Intel RealSense 2">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="openvino.html" class="navigation navigation-next " aria-label="Next page: OpenVino">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Model Conversion Pipeline","level":"1.6","depth":1,"next":{"title":"OpenVino","level":"1.7","depth":1,"path":"openvino.md","ref":"openvino.md","articles":[]},"previous":{"title":"Intel RealSense 2","level":"1.5","depth":1,"path":"rs2.md","ref":"rs2.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"model_convert.md","mtime":"2023-03-21T04:00:09.980Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-03-21T04:14:49.763Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

